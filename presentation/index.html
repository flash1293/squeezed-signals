<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Squeezed Signals: Observability Data Compression</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/black.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/monokai.css">
    <style>
        .reveal h1, .reveal h2, .reveal h3 {
            text-transform: none;
        }
        .reveal section {
            text-align: left;
        }
        .reveal section.center {
            text-align: center;
        }
        .reveal pre {
            width: 100%;
            font-size: 0.5em;
        }
        .reveal code {
            font-family: 'Courier New', monospace;
        }
        .reveal table {
            font-size: 0.7em;
        }
        .reveal .highlight {
            color: #42affa;
            font-weight: bold;
        }
        .reveal .success {
            color: #5cb85c;
        }
        .reveal .warning {
            color: #f0ad4e;
        }
        .reveal .danger {
            color: #d9534f;
        }
        .comparison-table {
            margin: 20px auto;
        }
        .comparison-table th {
            background-color: #42affa;
        }
        .comparison-table td {
            text-align: center;
        }
        .emoji {
            font-size: 1.5em;
        }
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .box {
            border: 2px solid #42affa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .small-text {
            font-size: 0.8em;
        }
        .formula {
            background: #1a1a1a;
            padding: 10px;
            border-left: 4px solid #42affa;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- Title Slide -->
            <section class="center">
                <h1>üóúÔ∏è Squeezed Signals</h1>
                <h3>The Evolution of Observability Data Storage</h3>
                <p style="margin-top: 50px;">A deep dive into compressing metrics and logs</p>
                <p class="small-text" style="margin-top: 50px;">Press <kbd>Space</kbd> to navigate ‚Üí</p>
            </section>

            <!-- PART 1: INTRODUCTION -->
            <section class="center">
                <h1>Part 1: Introduction</h1>
                <p>The Observability Data Problem</p>
            </section>

            <section>
                <h2>üî≠ What is Observability?</h2>
                <div class="box">
                    <p><strong>Observability</strong> = Understanding what's happening inside your systems</p>
                </div>
                <div class="two-column">
                    <div>
                        <h4>üìä Metrics</h4>
                        <p class="small-text">Numerical measurements</p>
                        <ul class="small-text">
                            <li>CPU usage: 72.3%</li>
                            <li>Requests/sec: 1,247</li>
                            <li>Memory: 4.2 GB</li>
                        </ul>
                    </div>
                    <div>
                        <h4>üìù Logs</h4>
                        <p class="small-text">Text event records</p>
                        <ul class="small-text">
                            <li>"User logged in"</li>
                            <li>"Error: Connection timeout"</li>
                            <li>"Request processed in 42ms"</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2>üéØ Project Goals</h2>
                <div class="box">
                    <h4>Primary Goal</h4>
                    <p>Demonstrate <span class="highlight">progressive compression techniques</span> from naive approaches to production-grade algorithms</p>
                </div>
                <div class="two-column" style="margin-top: 20px;">
                    <div class="box success">
                        <h4>‚úÖ What We'll Cover</h4>
                        <ul class="small-text">
                            <li>Lossless compression</li>
                            <li>Domain-specific techniques</li>
                            <li>Real-world algorithms</li>
                            <li>Measurable improvements</li>
                        </ul>
                    </div>
                    <div class="box warning">
                        <h4>‚ö†Ô∏è Important Note</h4>
                        <ul class="small-text">
                            <li>Focus: Storage size</li>
                            <li>Not covered deeply: Query speed, Ingest CPU</li>
                            <li>These matter in production!</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2>üìä Overview</h2>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Signal Type</th>
                            <th>Starting Size</th>
                            <th>Key Challenge</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>üìä Metrics</td>
                            <td>80.8 MB NDJSON</td>
                            <td>Temporal patterns in numbers</td>
                        </tr>
                        <tr>
                            <td>üìù Logs</td>
                            <td>72.7 MB Plain Text</td>
                            <td>Repeated structure with variables</td>
                        </tr>
                    </tbody>
                </table>
                <p class="small-text" style="text-align: center; margin-top: 30px;">
                    Each uses different strategies tailored to data characteristics
                </p>
                <p class="small-text" style="text-align: center; margin-top: 20px;">
                    <em>Note: Distributed traces compression covered in separate presentation (traces.html)</em>
                </p>
            </section>

            <!-- PART 2: METRICS -->
            <section class="center">
                <h1>Part 2: Metrics</h1>
                <p>üìä Time-Series Compression Journey</p>
            </section>

            <section>
                <h2>What Are Metrics?</h2>
                <div class="box">
                    <h4>Time-series numerical data</h4>
                    <p class="small-text">Regular intervals, labeled dimensions</p>
                </div>
                <pre><code class="language-json">{
  "metric_name": "system.cpu.user",
  "labels": {
    "host": "server-01",
    "datacenter": "us-west-1"
  },
  "timestamp": 1698000000,
  "value": 72.34567
}</code></pre>
                <p class="small-text"><strong>Key characteristics:</strong></p>
                <ul class="small-text">
                    <li>Timestamps are regular (e.g., every 60 seconds)</li>
                    <li>Values change slowly (temporal locality)</li>
                    <li>Labels repeat across many series</li>
                </ul>
            </section>

            <!-- Phase 1: NDJSON Baseline -->
            <section>
                <h2>Phase 1: NDJSON Baseline</h2>
                <div class="box">
                    <h4>Newline-Delimited JSON</h4>
                </div>
                <pre><code class="language-json">{"timestamp":1758824978,"metric_name":"sys_mem_total","value":8039006208.0,"labels":{"host":"system-14","region":"ap-southeast-1","environment":"staging"}}
{"timestamp":1758824980,"metric_name":"load_5m","value":0.18,"labels":{"host":"system-8","region":"us-west-2","environment":"prod"}}
{"timestamp":1758824980,"metric_name":"disk_io_time_bytes","value":0.0164000000004307,"labels":{"host":"system-8","region":"us-west-2","environment":"prod"}}
{"timestamp":1758824980,"metric_name":"sys_mem_available","value":4934422528.0,"labels":{"host":"system-8","region":"us-west-2","environment":"prod"}}
</code></pre>
                <p class="small-text"><strong>Observations:</strong></p>
                <ul class="small-text">
                    <li>Text-based, human-readable format</li>
                    <li>Repeated keys: "metric_name", "labels", "timestamp", "value"</li>
                    <li>Same metric name and labels repeated thousands of times</li>
                    <li>Timestamps are sequential (60 second intervals)</li>
                    <li>Values change slowly (temporal locality)</li>
                </ul>
            </section>

            <section>
                <h2>Phase 1: NDJSON Results</h2>
                <div class="box">
                    <h4>Baseline Metrics</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 80.8 MB</p>
                    <p><strong>Compression:</strong> 1.0x (baseline)</p>
                </div>
            </section>

            <!-- Phase 2: CBOR Binary -->
            <section>
                <h2>Phase 2: CBOR Binary Encoding</h2>
                <div class="box">
                    <h4>Switch to binary format</h4>
                </div>
                <pre><code class="language-plaintext"># JSON (text):
{"timestamp": 1698000000, "value": 72.34567}
# 45 bytes

# CBOR (binary):
A2                        # map(2 items)
  69 74696D657374616D70   # "timestamp" (9 bytes)
  1A 6536CD80             # unsigned(1698000000) (5 bytes)
  65 76616C7565           # "value" (5 bytes)
  FB 4052162C9D54F4E7     # float64(72.34567) (9 bytes)
# 29 bytes

# Benefits:
# - Integers stored as binary, not strings
# - Floats use IEEE 754 (8 bytes) instead of text representation
# - No whitespace or quotes needed
# - Still preserves all structure</code></pre>
            </section>

            <section>
                <h2>Phase 2: CBOR Results</h2>
                <div class="box">
                    <h4>Binary Encoding Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 63.9 MB</p>
                    <p><strong>Compression:</strong> 1.26x</p>
                    <p><strong>Improvement:</strong> Œî1.26x from Phase 1</p>
                </div>
                <p class="small-text highlight" style="text-align: center;">‚úÖ 1.26x compression through binary encoding</p>
            </section>

            <!-- Phase 3: CBOR + zstd -->
            <section>
                <h2>Phase 3: CBOR + zstd Compression</h2>
                <div class="box">
                    <h4>Add general-purpose compression</h4>
                </div>
                <div class="small-text">
                    <p><strong>zstd uses LZ77 back-references (sliding window):</strong></p>
                    <ul>
                        <li>Finds repeated byte sequences in recent data</li>
                        <li>Encodes as (offset, length) pairs</li>
                        <li>Example: "Copy 47 bytes from 3840 bytes ago"</li>
                        <li>Works great for CBOR label maps that repeat every 60s</li>
                    </ul>
                    <div class="formula" style="margin-top: 15px;">
                        <p><strong>Example encoding for metrics data:</strong></p>
                        <p class="small-text" style="font-family: monospace;">
                            [literal: timestamp=1758824980] [back-ref: offset=60, len=47] [literal: value=0.18]
                        </p>
                        <p class="small-text" style="margin-top: 5px;">
                            The middle back-reference copies the entire CBOR map for metric_name and labels from 60 bytes ago
                        </p>
                    </div>
                </div>
            </section>

            <section>
                <h2>Phase 3: CBOR + zstd Results</h2>
                <div class="box">
                    <h4>General-Purpose Compression Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 3.8 MB</p>
                    <p><strong>Compression:</strong> 21.3x</p>
                    <p><strong>Improvement:</strong> Œî16.8x from Phase 2</p>
                </div>
                <p class="small-text highlight" style="text-align: center;">‚úÖ Biggest single jump: 16.8x improvement from zstd!</p>
            </section>

            <!-- Phase 4: Binary Table -->
            <section>
                <h2>Phase 4: Binary Table with String Deduplication</h2>
                <div class="box">
                    <h4>Key Insight: String Deduplication + Binary Table Format</h4>
                </div>
                <pre><code class="language-python"># After: Binary table with string dictionary
String table (stored once):
  0: "system.cpu.user"
  1: "server-01"
  2: "us-west-1"

Binary rows (fixed-size records):
  [name_id: uint16, label_ids: uint16[], timestamp: uint64, value: float64]
  [0, [1, 2], 1698000000, 72.34589]
  [0, [1, 2], 1698000060, 72.34612]
  ...

# Benefits:
# - String deduplication: "system.cpu.user" stored once, not 1000x
# - Fixed-size binary rows: no field names, no delimiters
# - Small integer IDs compress better than back-references to strings</code></pre>
            </section>

            <section>
                <h2>Phase 4: Binary Table Results</h2>
                <div class="box">
                    <h4>String Deduplication Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 2.8 MB</p>
                    <p><strong>Compression:</strong> 28.9x</p>
                    <p><strong>Improvement:</strong> Œî1.36x from Phase 3</p>
                </div>
            </section>

            <!-- Phase 5: Columnar Storage -->
            <section>
                <h2>Phase 5: Columnar Storage</h2>
                    <div>
                        <h4>Row-oriented (Before)</h4>
                        <pre><code class="language-json">{
  "strings": {
    "0": "system.cpu.user",
    "1": "server-01",
    "2": "us-west-1",
    "3": "system.memory"
  },
  "series_data": {
    {"metric_name": 0, "label_ids": [1, 2], "timestamp": 1000, "value": 72.3},
    {"metric_name": 3, "label_ids": [1, 2], "timestamp": 1060, "value": 72.4},
  }
}</code></pre>
                    </div>
                    <div>
                        <h4>Column-oriented (After)</h4>
                        <pre><code class="language-json">{
  "strings": {
    "0": "system.cpu.user",
    "1": "server-01",
    "2": "us-west-1",
    "3": "system.memory"
  },
  "series_data": {
    "0": {"metric_name": 0, "label_ids": [1, 2], "timestamps": [...], "values": [...]},
    "1": {"metric_name": 3, "label_ids": [1, 2], "timestamps": [...], "values": [...]}
  }
}</code></pre>
                    </div>
            </section>

            <section>
                <h2>Phase 5: Columnar Storage Results</h2>
                <div class="box">
                    <h4>Columnar Layout Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 2.0 MB</p>
                    <p><strong>Compression:</strong> 40.4x</p>
                    <p><strong>Improvement:</strong> Œî1.40x from Phase 4</p>
                </div>
                <p class="small-text highlight" style="text-align: center;">‚úÖ 40.4x compression - columnar layout unlocks specialized algorithms</p>
            </section>

            <!-- Phase 6: Pattern-Aware Algorithms -->
            <section>
                <h2>Phase 6: Pattern-Aware Algorithms</h2>
                <div class="box danger">
                    <h4>The Breakthrough: Understand the Data!</h4>
                </div>
                <p class="small-text">Detect patterns and apply specialized compression:</p>
                <ul class="small-text">
                    <li><strong>Constant values:</strong> Store once + count (‚àû compression!)</li>
                    <li><strong>Delta encoding:</strong> Base value + deltas to previous value</li>
                    <li><strong>Many more:</strong>Near constant, Power-of-2, integer/fraction split, periodic templates, sparse storage</li> 
                </ul>
            </section>

            <section>
                <h2>Deep Dive: Delta Encoding</h2>
                <div class="box">
                    <h4>Store Differences, Not Absolute Values</h4>
                </div>
                <pre><code class="language-python"># Regular timestamps:
timestamps = [1000, 1060, 1120, 1180, 1240]
# Each: 8 bytes = 40 bytes total

# Delta encoding:
first = 1000
deltas = [60, 60, 60, 60]
# first (8 bytes) + deltas (4√ó2 bytes) = 16 bytes

# Double-delta (deltas of deltas):
deltas = [60, 60, 60, 60]
delta_deltas = [0, 0, 0]  # All zeros!
# Run-length encode: "60 repeated 4 times"
# Result: 12 bytes (3x compression!)</code></pre>
            </section>

            <section>
                <h2>Phase 6: Pattern-Aware Results</h2>
                <div class="box">
                    <h4>Pattern Detection Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 1.0 MB</p>
                    <p><strong>Compression:</strong> 79.7x</p>
                    <p><strong>Improvement:</strong> Œî1.97x from Phase 5</p>
                    <p><strong>Bytes per point:</strong> 3.19 bytes (vs 8 bytes original)</p>
                </div>
                <p class="highlight" style="margin-top: 20px; text-align: center;">
                    Result: 79.7x compression!
                </p>
            </section>

            <section>
                <h2>Metrics: Compression Journey</h2>
                <table style="font-size: 0.7em;">
                    <thead>
                        <tr>
                            <th>Phase</th>
                            <th>Technique</th>
                            <th>Size</th>
                            <th>Ratio</th>
                            <th>What Changed</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>NDJSON</td>
                            <td class="danger">80.8 MB</td>
                            <td>1.0x</td>
                            <td>None (baseline)</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>CBOR</td>
                            <td class="danger">63.9 MB</td>
                            <td>1.26x</td>
                            <td>Binary encoding</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>CBOR + zstd</td>
                            <td class="warning">3.8 MB</td>
                            <td class="success">21.3x</td>
                            <td>General compression</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Binary Table</td>
                            <td class="warning">2.8 MB</td>
                            <td class="success">28.9x</td>
                            <td>Deduplicate labels</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Columnar</td>
                            <td class="success">2.0 MB</td>
                            <td class="success">40.4x</td>
                            <td>Store series consecutively</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>Pattern-Aware</td>
                            <td class="success">1.0 MB</td>
                            <td class="success">79.7x</td>
                            <td>Delta/RLE algorithms</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section>
                <h2>Metrics: Key Takeaways</h2>
                <div class="box success">
                    <h4>‚úÖ What Worked</h4>
                    <ul class="small-text">
                        <li><strong>Binary encoding</strong> - Simple, 1.3x gain</li>
                        <li><strong>Generic compression</strong> - zstd gives 21x without domain knowledge</li>
                        <li><strong>Columnar storage</strong> - Group similar data types</li>
                        <li><strong>Pattern detection</strong> - Specialized algorithms per pattern type</li>
                    </ul>
                </div>
                <div class="box" style="margin-top: 10px;">
                    <h4>üéØ The Progression</h4>
                    <p class="small-text">
                        <span class="highlight">1x</span> (JSON) ‚Üí 
                        <span class="highlight">21x</span> (+ zstd) ‚Üí 
                        <span class="highlight">40x</span> (+ columnar) ‚Üí 
                        <span class="highlight">80x</span> (+ patterns)
                    </p>
                    <p class="small-text">Each technique builds on previous work!</p>
                </div>
            </section>

            <!-- PART 3: LOGS -->
            <section class="center">
                <h1>Part 3: Logs</h1>
                <p>üìù (Un)structured Text Compression</p>
            </section>

            <!-- Phase 1: Plain Text -->
            <section>
                <h2>Phase 1: Plain Text Baseline</h2>
                <div class="box">
                    <h4>Raw OpenSSH log files</h4>
                </div>
                <pre><code class="language-log">Dec 10 06:55:46 LabSZ sshd[24200]: reverse mapping checking getaddrinfo for ns.marryaldkfaczcz.com [173.234.31.186] failed - POSSIBLE BREAK-IN ATTEMPT!
Dec 10 06:55:46 LabSZ sshd[24200]: Invalid user webmaster from 173.234.31.186
Dec 10 06:55:46 LabSZ sshd[24200]: input_userauth_request: invalid user webmaster [preauth]
Dec 10 06:55:46 LabSZ sshd[24200]: pam_unix(sshd:auth): check pass; user unknown
Dec 10 06:55:46 LabSZ sshd[24200]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=173.234.31.186
Dec 10 06:55:48 LabSZ sshd[24200]: Failed password for invalid user webmaster from 173.234.31.186 port 38926 ssh2
Dec 10 06:55:48 LabSZ sshd[24200]: Connection closed by 173.234.31.186 [preauth]
Dec 10 07:02:47 LabSZ sshd[24203]: Connection closed by 212.47.254.145 [preauth]
</code></pre>
                <p class="small-text"><strong>Observations:</strong></p>
                <ul class="small-text">
                    <li>655,147 lines, each ~110 bytes average</li>
                    <li>Repeated structure: "timestamp hostname daemon[pid]: message"</li>
                    <li>Same message patterns with different variables</li>
                    <li>"Failed password for root" appears 139,818 times!</li>
                </ul>
            </section>

            <section>
                <h2>Phase 1: Plain Text Results</h2>
                <div class="box">
                    <h4>Baseline Metrics</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 72.7 MB</p>
                    <p><strong>Compression:</strong> 1.0x (baseline)</p>
                </div>
            </section>

            <!-- Phase 2: zstd -->
            <section>
                <h2>Phase 2: Plain Text + zstd</h2>
                <div class="box">
                    <h4>General compression finds patterns automatically</h4>
                </div>
                <pre><code class="language-plaintext"># zstd uses LZ77 back-references (sliding window):

Example log sequence:
Line 1: "Dec 10 06:55:46 LabSZ sshd[24200]: Failed password for root from 173.234.31.186"
Line 2: "Dec 10 06:55:48 LabSZ sshd[24200]: Failed password for root from 218.65.30.43"
Line 3: "Dec 10 07:14:32 LabSZ sshd[24200]: Failed password for root from 61.174.51.214"

Compressed output (simplified):
[literal: "Dec 10 06:55:46 LabSZ sshd[24200]: Failed password for root from 173.234.31.186\n"]
[literal: "Dec 10 06:55:48 "] [back-ref: offset=80, len=54] [literal: "218.65.30.43\n"]
[literal: "Dec 10 07:14:32 "] [back-ref: offset=160, len=54] [literal: "61.174.51.214\n"]

# Key insight: Repeated substring "LabSZ sshd[24200]: Failed password for root from "
# encoded as (offset, length) pairs instead of storing it 3 times
</code></pre>
            </section>

            <section>
                <h2>Phase 2: Plain Text + zstd Results</h2>
                <div class="box">
                    <h4>General Compression Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Original:</strong> 72.7 MB</p>
                    <p><strong>Compressed:</strong> 3.0 MB</p>
                    <p><strong>Compression:</strong> 24.5x</p>
                    <p><strong>Improvement:</strong> Œî24.5x from Phase 1</p>
                </div>
                <p class="small-text highlight" style="text-align: center;">‚úÖ 24.5x with zero domain knowledge - impressive!</p>
            </section>

            <!-- Phase 3: Template Extraction -->
            <section>
                <h2>Phase 3: Template Extraction</h2>
                <pre><code class="language-python"># Original log lines (3 examples):
Dec 10 06:55:48 LabSZ sshd[24200]: Failed password for root from 173.234.31.186 port 38926 ssh2
Dec 10 07:14:32 LabSZ sshd[24205]: Failed password for root from 218.65.30.43 port 54913 ssh2

{
  "templates": {
    "16": "< TIMESTAMP > LabSZ sshd[< NUM >]: Failed password for root from < IP > port < NUM > ssh2"
  },
  "line_to_template": [16, 16, 16, ...],  // 139,818 entries, all "16"
  "variables": {
    "TIMESTAMP": ["Dec 10 06:55:48", "Dec 10 07:14:32", "Dec 10 08:03:17", ...],
    "NUM_0": [24200, 24205, 24220, ...],     // pid
    "IP": ["173.234.31.186", "218.65.30.43", "61.174.51.214", ...],
    "NUM_1": [38926, 54913, 58389, ...]      // port
  }
}
</code></pre>
            </section>

            <section>
                <h2>Phase 3: Template Statistics</h2>
                <div class="box">
                    <h4>Only 5,669 unique templates for 655,147 lines!</h4>
                </div>
                <table style="font-size: 0.55em;">
                    <thead>
                        <tr>
                            <th>Template</th>
                            <th>Count</th>
                            <th>%</th>
                            <th>Reuse</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Failed password for root from &lt;IP&gt; port &lt;NUM&gt; ssh2</td>
                            <td class="success">139,818</td>
                            <td>21.3%</td>
                            <td class="success">139,818x</td>
                        </tr>
                        <tr>
                            <td>authentication failure; ... rhost=&lt;IP&gt; user=root</td>
                            <td>139,572</td>
                            <td>21.3%</td>
                            <td>139,572x</td>
                        </tr>
                        <tr>
                            <td>Connection closed by &lt;IP&gt; [preauth]</td>
                            <td>68,958</td>
                            <td>10.5%</td>
                            <td>68,958x</td>
                        </tr>
                        <tr>
                            <td>Received disconnect from &lt;IP&gt;: &lt;NUM&gt;: Bye Bye [preauth]</td>
                            <td>46,593</td>
                            <td>7.1%</td>
                            <td>46,593x</td>
                        </tr>
                        <tr>
                            <td>PAM service(sshd) ignoring max retries; &lt;NUM&gt; &gt; &lt;NUM&gt;</td>
                            <td>37,963</td>
                            <td>5.8%</td>
                            <td>37,963x</td>
                        </tr>
                        <tr>
                            <td colspan="4" class="small-text">...and 5,664 more templates</td>
                        </tr>
                    </tbody>
                </table>
                <div class="formula" style="margin-top: 20px;">
                    Average template reuse: 655,147 lines √∑ 5,669 templates = <span class="highlight">116x per template!</span>
                </div>
            </section>


            <section>
                <h2>Phase 3: Template Extraction Results</h2>
                <div class="box">
                    <h4>Template-Based Compression Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 2.0 MB</p>
                    <p><strong>Compression:</strong> 36.3x</p>
                    <p><strong>Improvement:</strong> Œî1.48x from Phase 2</p>
                </div>
            </section>

            <!-- Phase 4: Variable Encoding -->
            <section>
                <h2>Phase 4: Type-Aware Variable Encoding</h2>
                <div class="box">
                    <h4>Compress each variable type optimally</h4>
                </div>
                <pre><code class="language-python"># TIMESTAMP variables (655,147 occurrences):
Raw: ["Dec 10 06:55:46", "Dec 10 06:55:46", "Dec 10 06:55:48", ...]
Delta encoded:
  Base: 1682403746  # Epoch seconds for "Dec 10 06:55:46"
  Deltas: [0, 0, 2, 1, 58, 0, ...]  # Seconds difference

# IP variables (549,454 occurrences):
Raw: ["173.234.31.186", "173.234.31.186", "212.47.254.145", ...]
  Convert to uint32: [2910973370, 2910973370, 3561263233, ...]
</code></pre>
            </section>

            <section>
                <h2>Phase 4: Type-Aware Variable Results</h2>
                <div class="box">
                    <h4>Variable Encoding Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 1.9 MB</p>
                    <p><strong>Compression:</strong> 38.7x</p>
                    <p><strong>Improvement:</strong> Œî1.07x from Phase 3</p>
                </div>
            </section>

            <!-- Phase 5: Smart Row Ordering -->
            <section>
                <h2>Phase 5: Smart Row Ordering</h2>
                <pre><code class="language-python"># Strategy: Group by template, sort within groups by time
# Before (chronological, interleaved):
Line 1000: Template 16 "Failed password for root"
Line 1001: Template 6  "Connection closed"
Line 1002: Template 16 "Failed password for root"
Line 1003: Template 21 "authentication failure"
Line 1004: Template 16 "Failed password for root"
# Poor compression - similar patterns scattered

# After (grouped by template):
Template 16: "Failed password for root"  √ó 139,818 lines
  Dec 10 06:55:48 LabSZ sshd[24200]: ... from 173.234.31.186 port 38926 ssh2
  Dec 10 07:14:32 LabSZ sshd[24205]: ... from 218.65.30.43 port 54913 ssh2
  Dec 10 08:03:17 LabSZ sshd[24220]: ... from 61.174.51.214 port 58389 ssh2
  ... (all similar logs grouped)

Template 21: "authentication failure" √ó 139,572 lines
Template 6: "Connection closed" √ó 68,958 lines

# Benefits:
# - Similar variables adjacent ‚Üí better delta encoding
# - Template IDs grouped ‚Üí better RLE compression
# - zstd finds longer matching patterns
# - Note: We drop original line order to maximize compression</code></pre>
            </section>

            <section>
                <h2>Phase 5: Smart Row Ordering Results</h2>
                <div class="box">
                    <h4>Row Ordering Impact</h4>
                </div>
                <div class="formula">
                    <p><strong>Size:</strong> 1.77 MB</p>
                    <p><strong>Compression:</strong> 41.2x</p>
                    <p><strong>Improvement:</strong> Œî1.07x from Phase 4</p>
                </div>
            </section>

            <!-- Comparison slide -->
            <section>
                <h2>Logs: Compression Comparison</h2>
                <table style="font-size: 0.6em;">
                    <thead>
                        <tr>
                            <th>Phase</th>
                            <th>Format</th>
                            <th>Size</th>
                            <th>Ratio</th>
                            <th>Key Technique</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Plain Text</td>
                            <td class="danger">72.7 MB</td>
                            <td>1.0x</td>
                            <td>None (baseline)</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Plain + zstd</td>
                            <td class="warning">3.0 MB</td>
                            <td class="success">24.5x</td>
                            <td>Pattern dictionary</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Templates + zstd</td>
                            <td class="warning">2.0 MB</td>
                            <td class="success">36.3x</td>
                            <td>CLP template extraction</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Type-aware vars</td>
                            <td class="success">1.9 MB</td>
                            <td class="success">38.7x</td>
                            <td>Delta/dict per type</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Smart ordering</td>
                            <td class="success">1.77 MB</td>
                            <td class="success">41.2x</td>
                            <td>Group by template</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- PART 4: REALITY CHECK -->
            <section class="center">
                <h1>Part 3: Reality Check</h1>
                <p>‚öñÔ∏è Trade-offs & Practical Considerations</p>
            </section>

            <section>
                <h2>‚ö†Ô∏è The Compression Trilemma</h2>
                <div class="box danger">
                    <h4>You Can't Optimize Everything!</h4>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 20px;">
                    <div class="box">
                        <h4>üíæ Storage Size</h4>
                        <p class="small-text">Minimize disk usage</p>
                        <p class="success small-text">‚úÖ Focus of this project</p>
                    </div>
                    <div class="box">
                        <h4>‚ö° Ingest Speed</h4>
                        <p class="small-text">Fast data writing</p>
                        <p class="warning small-text">‚ö†Ô∏è CPU cost per write</p>
                    </div>
                    <div class="box">
                        <h4>üîç Query Speed</h4>
                        <p class="small-text">Fast data reading</p>
                        <p class="warning small-text">‚ö†Ô∏è Decompression overhead</p>
                    </div>
                </div>
                <p class="highlight" style="text-align: center; margin-top: 20px;">
                    Not always, but very often tradeoff desicions have to be made - optimizing one hurts the others
                </p>
            </section>

            <section>
                <h2>üí∞ Real-World Trade-offs</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 20px;">
                    <div class="box">
                        <h4>üíæ Optimize Storage</h4>
                        <p class="small-text"><strong>Analyze statistics, pick best algorithm</strong></p>
                        <p class="small-text" style="margin-top: 10px;"><em>Example:</em> Parquet - auto-selects dictionary/RLE/bit-packing per column based on cardinality and patterns</p>
                        <p class="danger small-text" style="margin-top: 10px;"><strong>Cost:</strong> Slow ingest & queries</p>
                    </div>
                    <div class="box">
                        <h4>‚ö° Optimize Ingest Speed</h4>
                        <p class="small-text"><strong>Write append-only, compress in background</strong></p>
                        <p class="small-text" style="margin-top: 10px;"><em>Example:</em> Grafana Loki - only lightweight general compression, no columnarization, no merging of chunks</p>
                        <p class="danger small-text" style="margin-top: 10px;"><strong>Cost:</strong> Higher storage, write amplification</p>
                    </div>
                    <div class="box">
                        <h4>üîç Optimize Query Speed</h4>
                        <p class="small-text"><strong>Build indexes to skip decompression</strong></p>
                        <p class="small-text" style="margin-top: 10px;"><em>Example:</em> Elasticsearch inverted indexes - skip 99% of documents without scanning</p>
                        <p class="danger small-text" style="margin-top: 10px;"><strong>Cost:</strong> 5-15% storage overhead</p>
                    </div>
                </div>
                <p class="small-text" style="margin-top: 20px; text-align: center;">
                    <strong>Key insight:</strong> Production systems use <span class="highlight">tiered storage</span> - different techniques for hot (recent), warm (weeks), and cold (archive) data
                </p>
            </section>

            <section>
                <h2>üéì Key Lessons Learned</h2>
                <div class="box success">
                    <h4>‚úÖ Domain Knowledge is Powerful</h4>
                    <p class="small-text">Understanding data characteristics enables <strong>order of magnitude</strong> better compression than generic algorithms alone</p>
                </div>
                <div class="box">
                    <h4>üìê The Compression Hierarchy</h4>
                    <ol class="small-text">
                        <li><strong>Binary encoding</strong> - Easy win, 1.3x</li>
                        <li><strong>Generic compression</strong> - zstd gives 10-30x baseline</li>
                        <li><strong>Structure optimization</strong> - Deduplication, columnar: +2-3x</li>
                        <li><strong>Domain-specific algorithms</strong> - Pattern-aware: +2-4x</li>
                    </ol>
                </div>
                <div class="box warning" style="margin-top: 10px;">
                    <h4>‚ö†Ô∏è No Free Lunch</h4>
                    <p class="small-text">Higher compression = Higher CPU cost. Choose based on your <strong>access patterns</strong> and <strong>scale</strong>.</p>
                </div>
            </section>

            <section>
                <h2>üî¨ Try It Yourself!</h2>
                <div class="box">
                    <h4>The squeezed-signals Repository</h4>
                    <p class="small-text">github.com/flash1293/squeezed-signals</p>
                </div>
                <pre><code class="language-bash"># Clone and set up
git clone https://github.com/flash1293/squeezed-signals.git
cd squeezed-signals
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# Try metrics compression
cd metrics
python main.py --size small

# Try logs compression  
cd ../logs
python main.py --size small
</code></pre>
                <p class="small-text" style="margin-top: 20px; text-align: center;">
                    <em>Traces compression covered in separate presentation (traces.html)</em>
                </p>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            controls: false,
            progress: true,
            center: true,
            transition: 'slide',
            width: 1200,
            height: 920,
            margin: 0.04,
            plugins: [ RevealHighlight, RevealNotes ]
        });
    </script>
</body>
</html>
